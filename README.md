ADMMsigma
================

See [vignette](https://htmlpreview.github.io/?https://github.com/MGallow/ADMMsigma/blob/master/vignette/ADMMsigma.html) or [manual](https://github.com/MGallow/ADMMsigma/blob/master/ADMMsigma.pdf).

Overview
--------

`ADMMsigma` is an R package that esetimates a penalized precision matrix via the alternating direction method of multipliers (ADMM) algorithm. A (possibly incomplete) list of functions contained in the package can be found below:

-   `ADMMsigma()` computes the estimated precision matrix (ridge, lasso, and elastic-net type regularization optional)

Installation
------------

``` r
# The easiest way to install is from the development version from GitHub:
# install.packages("devtools")
devtools::install_github("MGallow/ADMMsigma")
```

If there are any issues/bugs, please let me know: [github](https://github.com/MGallow/ADMMsigma/issues). You can also contact me via my [website](http://users.stat.umn.edu/~gall0441/). Pull requests are welcome!

Usage
-----

``` r
library(ADMMsigma)

# generate data from tri-diagonal (sparse) matrix for example
# first compute covariance matrix (can confirm inverse is tri-diagonal)
S = matrix(0, nrow = 10, ncol = 10)

for (i in 1:10){
  for (j in 1:10){
    S[i, j] = 0.7^(abs(i - j))
  }
}

# generate 100x10 matrix with rows drawn from iid N_p(0, S)
Z = matrix(rnorm(100*10), nrow = 100, ncol = 10)
out = eigen(S, symmetric = TRUE)
S.sqrt = out$vectors %*% diag(out$values^0.5) %*% t(out$vectors)
X = Z %*% S.sqrt


#ridge penalty (use CV for optimal lambda)
ADMMsigma(X, alpha = 0)
```

    ## $Iterations
    ## [1] 33
    ## 
    ## $lam
    ## [1] 0.03162278
    ## 
    ## $Omega
    ##              [,1]        [,2]        [,3]        [,4]        [,5]
    ##  [1,]  1.88679978 -1.12416288 -0.05944727  0.13404444 -0.19232399
    ##  [2,] -1.12416288  2.34299563 -0.77296206 -0.06194645  0.09732626
    ##  [3,] -0.05944727 -0.77296206  2.28692444 -0.84578879 -0.30521581
    ##  [4,]  0.13404444 -0.06194645 -0.84578879  2.16176727 -0.93429745
    ##  [5,] -0.19232399  0.09732626 -0.30521581 -0.93429745  2.14433637
    ##  [6,]  0.11360936 -0.20457680 -0.16200718  0.08881343 -0.84594779
    ##  [7,]  0.08856889  0.02942897  0.02675625 -0.10998631  0.10301719
    ##  [8,] -0.04241532 -0.07919293  0.26590020 -0.09045746 -0.28311791
    ##  [9,] -0.35482016 -0.09663798  0.26456326  0.05992240 -0.21892241
    ## [10,]  0.07737990  0.19877852 -0.29405323  0.05607467  0.19255053
    ##              [,6]        [,7]        [,8]        [,9]       [,10]
    ##  [1,]  0.11360936  0.08856889 -0.04241532 -0.35482016  0.07737990
    ##  [2,] -0.20457680  0.02942897 -0.07919293 -0.09663798  0.19877852
    ##  [3,] -0.16200718  0.02675625  0.26590020  0.26456326 -0.29405323
    ##  [4,]  0.08881343 -0.10998631 -0.09045746  0.05992240  0.05607467
    ##  [5,] -0.84594779  0.10301719 -0.28311791 -0.21892241  0.19255053
    ##  [6,]  2.23481082 -0.81691450 -0.19543518 -0.03538258  0.01083544
    ##  [7,] -0.81691450  1.93785767 -0.86114902 -0.01340640 -0.11282756
    ##  [8,] -0.19543518 -0.86114902  2.09309388 -0.70024288 -0.11894372
    ##  [9,] -0.03538258 -0.01340640 -0.70024288  2.33392270 -1.19042773
    ## [10,]  0.01083544 -0.11282756 -0.11894372 -1.19042773  1.83682506
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -1.084960e-04  1.457483e-04 -6.488493e-05 -2.880478e-05
    ##  [2,]  1.457483e-04 -2.479521e-04  1.735110e-04 -7.510503e-06
    ##  [3,] -6.488493e-05  1.735110e-04 -1.977208e-04  1.001594e-04
    ##  [4,] -2.880478e-05 -7.510503e-06  1.001594e-04 -1.609327e-04
    ##  [5,]  8.444910e-05 -1.161421e-04  1.160819e-05  1.477231e-04
    ##  [6,] -7.499457e-05  8.864871e-05  8.575442e-06 -1.352416e-04
    ##  [7,]  4.694701e-05 -4.736597e-05 -8.117622e-06  7.528765e-05
    ##  [8,] -4.739628e-05  4.858220e-05 -1.675927e-05 -1.224093e-05
    ##  [9,]  2.524506e-05  5.572912e-05 -1.000042e-04  1.199635e-05
    ## [10,]  4.063989e-06 -8.188533e-05  1.080653e-04 -1.786036e-05
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  8.444910e-05 -7.499457e-05  4.694701e-05 -4.739628e-05
    ##  [2,] -1.161421e-04  8.864871e-05 -4.736597e-05  4.858220e-05
    ##  [3,]  1.160819e-05  8.575442e-06 -8.117622e-06 -1.675927e-05
    ##  [4,]  1.477231e-04 -1.352416e-04  7.528765e-05 -1.224093e-05
    ##  [5,] -2.216115e-04  1.939065e-04 -1.170316e-04  4.716327e-05
    ##  [6,]  1.939065e-04 -1.809991e-04  1.233229e-04 -6.549191e-05
    ##  [7,] -1.170316e-04  1.233229e-04 -1.094807e-04  8.498794e-05
    ##  [8,]  4.716327e-05 -6.549191e-05  8.498794e-05 -9.725196e-05
    ##  [9,]  4.915645e-05  8.859813e-07 -5.501507e-05  9.869553e-05
    ## [10,] -5.232077e-05  1.418940e-05  2.496577e-05 -5.260103e-05
    ##                [,9]         [,10]
    ##  [1,]  2.524506e-05  4.063989e-06
    ##  [2,]  5.572912e-05 -8.188533e-05
    ##  [3,] -1.000042e-04  1.080653e-04
    ##  [4,]  1.199635e-05 -1.786036e-05
    ##  [5,]  4.915645e-05 -5.232077e-05
    ##  [6,]  8.859813e-07  1.418940e-05
    ##  [7,] -5.501507e-05  2.496577e-05
    ##  [8,]  9.869553e-05 -5.260103e-05
    ##  [9,] -2.482779e-04  1.823237e-04
    ## [10,]  1.823237e-04 -1.432556e-04

``` r
#lasso penalty (use CV for optimal lambda)
ADMMsigma(X)
```

    ## $Iterations
    ## [1] 41
    ## 
    ## $lam
    ## [1] 0.03162278
    ## 
    ## $Omega
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,]  2.039561e+00 -1.320096e+00  4.697987e-05  4.567981e-02
    ##  [2,] -1.320096e+00  2.603937e+00 -8.606295e-01  2.842885e-05
    ##  [3,]  4.697987e-05 -8.606295e-01  2.404053e+00 -9.665526e-01
    ##  [4,]  4.567981e-02  2.842885e-05 -9.665526e-01  2.396077e+00
    ##  [5,] -7.817603e-02  1.197045e-05 -2.265432e-01 -1.069746e+00
    ##  [6,]  1.001311e-05 -1.428775e-01 -3.978810e-02  4.765352e-05
    ##  [7,]  6.957427e-02 -1.303287e-05 -1.802456e-05  1.441684e-05
    ##  [8,]  1.506256e-05 -8.997184e-03  1.143767e-01  2.472685e-05
    ##  [9,] -3.431350e-01  9.009021e-06  9.768974e-02 -1.776427e-06
    ## [10,]  4.102287e-02  7.706334e-02 -4.092891e-02  4.513400e-06
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,] -7.817603e-02  1.001311e-05  6.957427e-02  1.506256e-05
    ##  [2,]  1.197045e-05 -1.428775e-01 -1.303287e-05 -8.997184e-03
    ##  [3,] -2.265432e-01 -3.978810e-02 -1.802456e-05  1.143767e-01
    ##  [4,] -1.069746e+00  4.765352e-05  1.441684e-05  2.472685e-05
    ##  [5,]  2.284402e+00 -9.149478e-01  5.760835e-03 -2.513244e-01
    ##  [6,] -9.149478e-01  2.365285e+00 -8.750366e-01 -1.676387e-01
    ##  [7,]  5.760835e-03 -8.750366e-01  2.091838e+00 -9.682701e-01
    ##  [8,] -2.513244e-01 -1.676387e-01 -9.682701e-01  2.209870e+00
    ##  [9,] -8.220497e-02 -2.992570e-06  8.300409e-06 -8.882471e-01
    ## [10,]  6.775038e-02 -1.161164e-05 -6.981364e-02  7.010994e-05
    ##                [,9]         [,10]
    ##  [1,] -3.431350e-01  4.102287e-02
    ##  [2,]  9.009021e-06  7.706334e-02
    ##  [3,]  9.768974e-02 -4.092891e-02
    ##  [4,] -1.776427e-06  4.513400e-06
    ##  [5,] -8.220497e-02  6.775038e-02
    ##  [6,] -2.992570e-06 -1.161164e-05
    ##  [7,]  8.300409e-06 -6.981364e-02
    ##  [8,] -8.882471e-01  7.010994e-05
    ##  [9,]  2.587162e+00 -1.349712e+00
    ## [10,] -1.349712e+00  1.942045e+00
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -2.084648e-04  2.303439e-04  2.491811e-02 -6.306537e-05
    ##  [2,]  2.303439e-04 -3.295658e-04  1.116575e-04  3.498497e-02
    ##  [3,]  2.491811e-02  1.116575e-04 -1.971834e-04  1.749383e-04
    ##  [4,] -6.306537e-05  3.498497e-02  1.749383e-04 -2.536552e-04
    ##  [5,]  8.027366e-06  4.926888e-02 -6.060841e-05  1.218209e-04
    ##  [6,]  1.143434e-02  1.145439e-05 -1.454733e-05  2.692110e-02
    ##  [7,] -1.164742e-05 -3.687319e-02 -4.797059e-02  4.653575e-02
    ##  [8,]  4.890742e-02 -1.167416e-05  1.422593e-05  5.453762e-02
    ##  [9,]  7.667678e-05  5.391181e-02 -6.326533e-05 -5.577728e-02
    ## [10,] -4.582711e-05 -1.439562e-05  5.132891e-05  3.726021e-03
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  8.027366e-06  1.143434e-02 -1.164742e-05  4.890742e-02
    ##  [2,]  4.926888e-02  1.145439e-05 -3.687319e-02 -1.167416e-05
    ##  [3,] -6.060841e-05 -1.454733e-05 -4.797059e-02  1.422593e-05
    ##  [4,]  1.218209e-04  2.692110e-02  4.653575e-02  5.453762e-02
    ##  [5,] -1.163594e-04  7.199301e-05 -5.225331e-05  2.504913e-05
    ##  [6,]  7.199301e-05 -1.183091e-04  9.812509e-05 -5.251362e-05
    ##  [7,] -5.225331e-05  9.812509e-05 -1.102266e-04  8.705886e-05
    ##  [8,]  2.504913e-05 -5.251362e-05  8.705886e-05 -1.235834e-04
    ##  [9,]  3.471557e-05 -6.044990e-03  4.158927e-02  8.045328e-05
    ## [10,] -3.416403e-05 -2.297109e-02 -3.415203e-05  5.303996e-02
    ##                [,9]         [,10]
    ##  [1,]  7.667678e-05 -4.582711e-05
    ##  [2,]  5.391181e-02 -1.439562e-05
    ##  [3,] -6.326533e-05  5.132891e-05
    ##  [4,] -5.577728e-02  3.726021e-03
    ##  [5,]  3.471557e-05 -3.416403e-05
    ##  [6,] -6.044990e-03 -2.297109e-02
    ##  [7,]  4.158927e-02 -3.415203e-05
    ##  [8,]  8.045328e-05  5.303996e-02
    ##  [9,] -3.370406e-04  2.378459e-04
    ## [10,]  2.378459e-04 -2.003017e-04

``` r
# lasso penalty (lam = 0.1)
ADMMsigma(X, lam = 0.1)
```

    ## $Iterations
    ## [1] 24
    ## 
    ## $lam
    ## [1] 0.1
    ## 
    ## $Omega
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,]  1.4795660231 -0.7772119808  0.0001308889  0.0001552911
    ##  [2,] -0.7772119808  1.7837751595 -0.5228906078  0.0001230832
    ##  [3,]  0.0001308889 -0.5228906078  1.7161926754 -0.5800505250
    ##  [4,]  0.0001552911  0.0001230832 -0.5800505250  1.6805287941
    ##  [5,] -0.0651962726 -0.0166124114 -0.1751190898 -0.6847191262
    ##  [6,]  0.0000167041 -0.0870558232 -0.0115829678  0.0001337697
    ##  [7,]  0.0001860279  0.0002420624  0.0001850443  0.0002231597
    ##  [8,]  0.0002036247  0.0003247792  0.0002541938  0.0002130141
    ##  [9,] -0.1522627621  0.0002475235  0.0002925344  0.0002270949
    ## [10,]  0.0001776425  0.0003782614  0.0003950486  0.0003316030
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,] -0.0651962726  0.0000167041  0.0001860279  0.0002036247
    ##  [2,] -0.0166124114 -0.0870558232  0.0002420624  0.0003247792
    ##  [3,] -0.1751190898 -0.0115829678  0.0001850443  0.0002541938
    ##  [4,] -0.6847191262  0.0001337697  0.0002231597  0.0002130141
    ##  [5,]  1.6144540747 -0.6148017824  0.0001243843 -0.1719405063
    ##  [6,] -0.6148017824  1.6987871739 -0.5631705507 -0.1490695617
    ##  [7,]  0.0001243843 -0.5631705507  1.5095284680 -0.6301956413
    ##  [8,] -0.1719405063 -0.1490695617 -0.6301956413  1.5936652280
    ##  [9,] -0.0267141526 -0.0122192607 -0.0081128098 -0.5732826445
    ## [10,]  0.0001625835  0.0001141364 -0.0579873805 -0.0300814363
    ##                [,9]         [,10]
    ##  [1,] -0.1522627621  0.0001776425
    ##  [2,]  0.0002475235  0.0003782614
    ##  [3,]  0.0002925344  0.0003950486
    ##  [4,]  0.0002270949  0.0003316030
    ##  [5,] -0.0267141526  0.0001625835
    ##  [6,] -0.0122192607  0.0001141364
    ##  [7,] -0.0081128098 -0.0579873805
    ##  [8,] -0.5732826445 -0.0300814363
    ##  [9,]  1.7319814942 -0.8015475551
    ## [10,] -0.8015475551  1.4307425359
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -7.256881e-05  7.712527e-05  1.715362e-01  1.365158e-01
    ##  [2,]  7.712527e-05 -1.347408e-04  1.952536e-05  1.906834e-01
    ##  [3,]  1.715362e-01  1.952536e-05 -9.606771e-05  8.427809e-05
    ##  [4,]  1.365158e-01  1.906834e-01  8.427809e-05 -2.059486e-04
    ##  [5,] -4.061426e-05 -8.104623e-06 -3.278490e-05  1.016623e-04
    ##  [6,]  1.423923e-01 -5.598479e-05 -4.173166e-05  1.918949e-01
    ##  [7,]  1.033408e-01  1.366150e-01  1.171774e-01  1.995834e-01
    ##  [8,]  1.695712e-01  1.683394e-01  6.180940e-02  1.783489e-01
    ##  [9,] -8.457200e-05  1.593648e-01  6.235592e-02  1.192261e-01
    ## [10,]  9.519527e-02  6.355695e-02  1.175780e-01  8.946215e-02
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,] -4.061426e-05  1.423923e-01  1.033408e-01  1.695712e-01
    ##  [2,] -8.104623e-06 -5.598479e-05  1.366150e-01  1.683394e-01
    ##  [3,] -3.278490e-05 -4.173166e-05  1.171774e-01  6.180940e-02
    ##  [4,]  1.016623e-04  1.918949e-01  1.995834e-01  1.783489e-01
    ##  [5,] -1.133992e-04  8.764629e-05  1.680168e-01 -7.537299e-06
    ##  [6,]  8.764629e-05 -9.428730e-05  5.668971e-05 -5.526689e-05
    ##  [7,]  1.680168e-01  5.668971e-05 -1.311612e-04  1.384870e-04
    ##  [8,] -7.537299e-06 -5.526689e-05  1.384870e-04 -1.974888e-04
    ##  [9,] -6.117589e-05  2.329383e-05 -1.402119e-04  2.514313e-04
    ## [10,]  9.625731e-02  1.565075e-01  6.327257e-05 -1.758364e-04
    ##                [,9]         [,10]
    ##  [1,] -8.457200e-05  9.519527e-02
    ##  [2,]  1.593648e-01  6.355695e-02
    ##  [3,]  6.235592e-02  1.175780e-01
    ##  [4,]  1.192261e-01  8.946215e-02
    ##  [5,] -6.117589e-05  9.625731e-02
    ##  [6,]  2.329383e-05  1.565075e-01
    ##  [7,] -1.402119e-04  6.327257e-05
    ##  [8,]  2.514313e-04 -1.758364e-04
    ##  [9,] -2.991033e-04  2.009658e-04
    ## [10,]  2.009658e-04 -1.388655e-04

``` r
#elastic-net type penalty (use CV for optimal lambda)
ADMMsigma(X, alpha = 0.5)
```

    ## $Iterations
    ## [1] 22
    ## 
    ## $lam
    ## [1] 0.03162278
    ## 
    ## $Omega
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,]  1.942164e+00 -1.210663e+00  8.968458e-05  0.0711936141
    ##  [2,] -1.210663e+00  2.453687e+00 -8.198109e-01  0.0001389321
    ##  [3,]  8.968458e-05 -8.198109e-01  2.318052e+00 -0.8938342738
    ##  [4,]  7.119361e-02  1.389321e-04 -8.938343e-01  2.2466288508
    ##  [5,] -1.188687e-01  8.391483e-05 -2.601796e-01 -0.9745966718
    ##  [6,]  2.457289e-02 -1.393788e-01 -9.363062e-02  0.0002533788
    ##  [7,]  8.870090e-02 -1.809651e-04 -1.594712e-04 -0.0238698572
    ##  [8,]  1.525587e-04 -5.401088e-02  1.895825e-01 -0.0383976774
    ##  [9,] -3.609288e-01 -2.892914e-02  1.868596e-01  0.0162407487
    ## [10,]  5.905945e-02  1.368292e-01 -1.775594e-01  0.0292944582
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,] -1.188687e-01  0.0245728870  0.0887008962  0.0001525587
    ##  [2,]  8.391483e-05 -0.1393787889 -0.0001809651 -0.0540108754
    ##  [3,] -2.601796e-01 -0.0936306216 -0.0001594712  0.1895825380
    ##  [4,] -9.745967e-01  0.0002533788 -0.0238698572 -0.0383976774
    ##  [5,]  2.189778e+00 -0.8531158047  0.0461639459 -0.2688566645
    ##  [6,] -8.531158e-01  2.2839720656 -0.8388290724 -0.1848530760
    ##  [7,]  4.616395e-02 -0.8388290724  1.9989465950 -0.9065994985
    ##  [8,] -2.688567e-01 -0.1848530760 -0.9065994985  2.1342587684
    ##  [9,] -1.568308e-01 -0.0051282654  0.0002271282 -0.7946943881
    ## [10,]  1.370611e-01 -0.0001762242 -0.1024340691 -0.0471685139
    ##                [,9]         [,10]
    ##  [1,] -0.3609287550  0.0590594540
    ##  [2,] -0.0289291351  0.1368291654
    ##  [3,]  0.1868596214 -0.1775594318
    ##  [4,]  0.0162407487  0.0292944582
    ##  [5,] -0.1568308096  0.1370611291
    ##  [6,] -0.0051282654 -0.0001762242
    ##  [7,]  0.0002271282 -0.1024340691
    ##  [8,] -0.7946943881 -0.0471685139
    ##  [9,]  2.4323141643 -1.2500151235
    ## [10,] -1.2500151235  1.8674188542
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -1.681994e-04  1.776358e-04  2.185263e-02 -5.990200e-05
    ##  [2,]  1.776358e-04 -2.478254e-04  7.233237e-05  2.002270e-02
    ##  [3,]  2.185263e-02  7.233237e-05 -1.350265e-04  1.125338e-04
    ##  [4,] -5.990200e-05  2.002270e-02  1.125338e-04 -1.847392e-04
    ##  [5,] -4.514395e-06  1.306187e-02 -3.698896e-05  8.663987e-05
    ##  [6,]  3.099685e-06  3.946056e-06 -5.613983e-06  6.585174e-03
    ##  [7,] -1.063185e-05 -2.291742e-02 -2.606891e-02  1.201643e-05
    ##  [8,]  2.969956e-02 -1.060974e-05  4.165451e-05 -3.979659e-05
    ##  [9,]  8.743409e-05 -1.402868e-06 -9.681680e-05  3.569699e-05
    ## [10,] -6.091035e-05 -7.139027e-06  7.635093e-05 -2.299731e-05
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,] -4.514395e-06  3.099685e-06 -1.063185e-05  2.969956e-02
    ##  [2,]  1.306187e-02  3.946056e-06 -2.291742e-02 -1.060974e-05
    ##  [3,] -3.698896e-05 -5.613983e-06 -2.606891e-02  4.165451e-05
    ##  [4,]  8.663987e-05  6.585174e-03  1.201643e-05 -3.979659e-05
    ##  [5,] -1.002196e-04  6.247697e-05 -5.681257e-05  3.080948e-05
    ##  [6,]  6.247697e-05 -1.473079e-04  1.249802e-04 -4.067477e-05
    ##  [7,] -5.681257e-05  1.249802e-04 -1.214557e-04  5.238069e-05
    ##  [8,]  3.080948e-05 -4.067477e-05  5.238069e-05 -7.649050e-05
    ##  [9,]  2.142956e-05 -8.677966e-06  2.270960e-02  9.849374e-05
    ## [10,] -7.541140e-06 -1.036442e-02 -4.597767e-06 -6.540916e-05
    ##                [,9]         [,10]
    ##  [1,]  8.743409e-05 -6.091035e-05
    ##  [2,] -1.402868e-06 -7.139027e-06
    ##  [3,] -9.681680e-05  7.635093e-05
    ##  [4,]  3.569699e-05 -2.299731e-05
    ##  [5,]  2.142956e-05 -7.541140e-06
    ##  [6,] -8.677966e-06 -1.036442e-02
    ##  [7,]  2.270960e-02 -4.597767e-06
    ##  [8,]  9.849374e-05 -6.540916e-05
    ##  [9,] -3.713373e-04  2.592391e-04
    ## [10,]  2.592391e-04 -1.835695e-04
