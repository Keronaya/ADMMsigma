ADMMsigma
================

See [vignette](https://htmlpreview.github.io/?https://github.com/MGallow/ADMMsigma/blob/master/vignette/Vignette.html) or [manual](https://github.com/MGallow/ADMMsigma/blob/master/ADMMsigma.pdf).

Overview
--------

`ADMMsigma` is an R package that esetimates a penalized precision matrix via the alternating direction method of multipliers (ADMM) algorithm. A (possibly incomplete) list of functions contained in the package can be found below:

-   `ADMMsigma()` computes the estimated precision matrix (ridge, lasso, and elastic-net type regularization optional)

Installation
------------

``` r
# The easiest way to install is from the development version from GitHub:
# install.packages("devtools")
devtools::install_github("MGallow/ADMMsigma")
```

If there are any issues/bugs, please let me know: [github](https://github.com/MGallow/ADMMsigma/issues). You can also contact me via my [website](http://users.stat.umn.edu/~gall0441/). Pull requests are welcome!

Usage
-----

``` r
library(ADMMsigma)

# generate data from tri-diagonal (sparse) matrix for example
# first compute covariance matrix (can confirm inverse is tri-diagonal)
S = matrix(0, nrow = 10, ncol = 10)

for (i in 1:10){
  for (j in 1:10){
    S[i, j] = 0.7^(abs(i - j))
  }
}

# generate 100x10 matrix with rows drawn from iid N_p(0, S)
Z = matrix(rnorm(100*10), nrow = 100, ncol = 10)
out = eigen(S, symmetric = TRUE)
S.sqrt = out$vectors %*% diag(out$values^0.5) %*% t(out$vectors)
X = Z %*% S.sqrt


#ridge penalty (use CV for optimal lambda)
ADMMsigma(X, alpha = 0)
```

    ## $Iterations
    ## [1] 31
    ## 
    ## $lam
    ## [1] 0.03162278
    ## 
    ## $Omega
    ##              [,1]        [,2]        [,3]         [,4]        [,5]
    ##  [1,]  1.70119913 -0.58916294 -0.39979599 -0.064884005 -0.01650457
    ##  [2,] -0.58916294  1.84432108 -0.82940481 -0.112772363  0.13146342
    ##  [3,] -0.39979599 -0.82940481  2.21682653 -0.877396780 -0.09944739
    ##  [4,] -0.06488401 -0.11277236 -0.87739678  2.278022221 -0.99424529
    ##  [5,] -0.01650457  0.13146342 -0.09944739 -0.994245293  2.23156786
    ##  [6,] -0.04076449  0.05409827 -0.01692134 -0.270670458 -0.93534745
    ##  [7,] -0.09668853  0.12416215  0.05590929 -0.009530239 -0.23674062
    ##  [8,] -0.02139251 -0.07100239  0.01256072 -0.032341657  0.08028272
    ##  [9,]  0.18664558  0.09774767 -0.21732180  0.078902626  0.12531386
    ## [10,] -0.04320700  0.05360121 -0.09112862  0.025766773 -0.26517831
    ##              [,6]         [,7]        [,8]        [,9]       [,10]
    ##  [1,] -0.04076449 -0.096688532 -0.02139251  0.18664558 -0.04320700
    ##  [2,]  0.05409827  0.124162147 -0.07100239  0.09774767  0.05360121
    ##  [3,] -0.01692134  0.055909295  0.01256072 -0.21732180 -0.09112862
    ##  [4,] -0.27067046 -0.009530239 -0.03234166  0.07890263  0.02576677
    ##  [5,] -0.93534745 -0.236740618  0.08028272  0.12531386 -0.26517831
    ##  [6,]  2.36593766 -0.723795795 -0.26555052 -0.13935372  0.18230312
    ##  [7,] -0.72379580  1.987304329 -0.73981874 -0.02576830 -0.01042287
    ##  [8,] -0.26555052 -0.739818741  2.08170845 -0.94563411 -0.08649444
    ##  [9,] -0.13935372 -0.025768300 -0.94563411  1.97030695 -0.88172463
    ## [10,]  0.18230312 -0.010422874 -0.08649444 -0.88172463  1.69241947
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -7.554151e-06 -1.054690e-06  1.491752e-05 -1.670988e-05
    ##  [2,] -1.054690e-06 -5.024567e-05  8.518825e-05 -6.276555e-05
    ##  [3,]  1.491752e-05  8.518825e-05 -1.989457e-04  2.041745e-04
    ##  [4,] -1.670988e-05 -6.276555e-05  2.041745e-04 -2.776452e-04
    ##  [5,]  5.644542e-06  8.653642e-06 -1.110111e-04  2.340159e-04
    ##  [6,]  3.800672e-06  2.217971e-05  1.090255e-05 -9.668529e-05
    ##  [7,] -5.160316e-06 -2.500416e-05  3.390813e-05 -1.845069e-05
    ##  [8,]  1.394547e-05  3.487515e-05 -6.638797e-05  6.332972e-05
    ##  [9,] -1.995229e-05 -4.293577e-05  7.088411e-05 -3.269246e-05
    ## [10,]  9.983361e-06  1.192423e-05 -1.743601e-06 -4.050668e-05
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  5.644542e-06  3.800672e-06 -5.160316e-06  1.394547e-05
    ##  [2,]  8.653642e-06  2.217971e-05 -2.500416e-05  3.487515e-05
    ##  [3,] -1.110111e-04  1.090255e-05  3.390813e-05 -6.638797e-05
    ##  [4,]  2.340159e-04 -9.668529e-05 -1.845069e-05  6.332972e-05
    ##  [5,] -3.086534e-04  2.183520e-04 -4.100295e-05 -2.066624e-05
    ##  [6,]  2.183520e-04 -2.212641e-04  8.740027e-05 -3.216651e-05
    ##  [7,] -4.100295e-05  8.740027e-05 -8.556943e-05  8.988472e-05
    ##  [8,] -2.066624e-05 -3.216651e-05  8.988472e-05 -1.479091e-04
    ##  [9,] -4.831154e-05  8.665704e-05 -9.431887e-05  1.444331e-04
    ## [10,]  9.104112e-05 -8.622980e-05  4.885064e-05 -5.942155e-05
    ##                [,9]         [,10]
    ##  [1,] -1.995229e-05  9.983361e-06
    ##  [2,] -4.293577e-05  1.192423e-05
    ##  [3,]  7.088411e-05 -1.743601e-06
    ##  [4,] -3.269246e-05 -4.050668e-05
    ##  [5,] -4.831154e-05  9.104112e-05
    ##  [6,]  8.665704e-05 -8.622980e-05
    ##  [7,] -9.431887e-05  4.885064e-05
    ##  [8,]  1.444331e-04 -5.942155e-05
    ##  [9,] -1.697360e-04  8.827833e-05
    ## [10,]  8.827833e-05 -6.228474e-05

``` r
#lasso penalty (use CV for optimal lambda)
ADMMsigma(X)
```

    ## $Iterations
    ## [1] 44
    ## 
    ## $lam
    ## [1] 0.03162278
    ## 
    ## $Omega
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,]  1.702653e+00 -5.969108e-01 -4.031925e-01 -7.377916e-02
    ##  [2,] -5.969108e-01  1.901945e+00 -9.021374e-01 -2.131353e-06
    ##  [3,] -4.031925e-01 -9.021374e-01  2.403213e+00 -1.091097e+00
    ##  [4,] -7.377916e-02 -2.131353e-06 -1.091097e+00  2.568823e+00
    ##  [5,]  2.137445e-05  6.852627e-02  7.787213e-05 -1.227410e+00
    ##  [6,] -1.303583e-02 -3.005311e-05  8.307872e-06 -1.714026e-01
    ##  [7,] -4.736729e-02  8.518404e-02  5.077481e-06 -4.241508e-05
    ##  [8,] -1.986156e-06 -2.907257e-06 -1.463118e-02 -2.555288e-05
    ##  [9,]  8.895336e-02  7.886105e-02 -1.206138e-01  2.758782e-02
    ## [10,] -1.384908e-06 -4.586864e-06 -6.559546e-02  8.711349e-06
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  2.137445e-05 -1.303583e-02 -4.736729e-02 -1.986156e-06
    ##  [2,]  6.852627e-02 -3.005311e-05  8.518404e-02 -2.907257e-06
    ##  [3,]  7.787213e-05  8.307872e-06  5.077481e-06 -1.463118e-02
    ##  [4,] -1.227410e+00 -1.714026e-01 -4.241508e-05 -2.555288e-05
    ##  [5,]  2.524236e+00 -1.148499e+00 -1.108837e-01 -1.093398e-05
    ##  [6,] -1.148499e+00  2.616238e+00 -8.954025e-01 -2.081055e-01
    ##  [7,] -1.108837e-01 -8.954025e-01  2.110792e+00 -8.179267e-01
    ##  [8,] -1.093398e-05 -2.081055e-01 -8.179267e-01  2.241146e+00
    ##  [9,]  2.229815e-02  1.116058e-05  1.581546e-05 -1.096834e+00
    ## [10,] -1.166292e-01  2.026203e-05  1.689058e-05  1.080894e-05
    ##                [,9]         [,10]
    ##  [1,]  8.895336e-02 -1.384908e-06
    ##  [2,]  7.886105e-02 -4.586864e-06
    ##  [3,] -1.206138e-01 -6.559546e-02
    ##  [4,]  2.758782e-02  8.711349e-06
    ##  [5,]  2.229815e-02 -1.166292e-01
    ##  [6,]  1.116058e-05  2.026203e-05
    ##  [7,]  1.581546e-05  1.689058e-05
    ##  [8,] -1.096834e+00  1.080894e-05
    ##  [9,]  2.117319e+00 -9.604885e-01
    ## [10,] -9.604885e-01  1.731274e+00
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -1.199144e-06 -2.958892e-06  9.322370e-06 -1.232104e-05
    ##  [2,] -2.958892e-06 -3.975352e-05  6.626253e-05 -1.722024e-02
    ##  [3,]  9.322370e-06  6.626253e-05 -1.499075e-04  9.586002e-05
    ##  [4,] -1.232104e-05 -1.722024e-02  9.586002e-05 -2.451512e-04
    ##  [5,]  6.038084e-02 -5.174498e-05  4.411166e-02  2.826708e-04
    ##  [6,]  1.376833e-05 -5.649518e-02  4.919663e-02 -1.524129e-04
    ##  [7,] -6.133396e-06  1.679702e-05  3.333014e-02 -1.587159e-02
    ##  [8,] -5.303203e-03 -1.978107e-02  3.658977e-06 -2.234617e-02
    ##  [9,] -1.576004e-06 -1.486521e-06  6.024422e-07  1.008481e-05
    ## [10,] -2.381402e-02 -5.646830e-02 -3.614231e-06  2.614499e-02
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  6.038084e-02  1.376833e-05 -6.133396e-06 -5.303203e-03
    ##  [2,] -5.174498e-05 -5.649518e-02  1.679702e-05 -1.978107e-02
    ##  [3,]  4.411166e-02  4.919663e-02  3.333014e-02  3.658977e-06
    ##  [4,]  2.826708e-04 -1.524129e-04 -1.587159e-02 -2.234617e-02
    ##  [5,] -4.926874e-04  3.607502e-04 -8.724428e-05 -4.456097e-02
    ##  [6,]  3.607502e-04 -3.579810e-04  1.393986e-04 -1.248086e-05
    ##  [7,] -8.724428e-05  1.393986e-04 -7.450507e-05  1.661628e-05
    ##  [8,] -4.456097e-02 -1.248086e-05  1.661628e-05 -1.668487e-05
    ##  [9,] -9.182097e-06  4.985114e-02  3.616133e-02  8.817549e-06
    ## [10,]  1.227595e-06  6.382632e-03  3.965203e-02  5.123996e-02
    ##                [,9]         [,10]
    ##  [1,] -1.576004e-06 -2.381402e-02
    ##  [2,] -1.486521e-06 -5.646830e-02
    ##  [3,]  6.024422e-07 -3.614231e-06
    ##  [4,]  1.008481e-05  2.614499e-02
    ##  [5,] -9.182097e-06  1.227595e-06
    ##  [6,]  4.985114e-02  6.382632e-03
    ##  [7,]  3.616133e-02  3.965203e-02
    ##  [8,]  8.817549e-06  5.123996e-02
    ##  [9,] -1.402352e-05  4.026608e-06
    ## [10,]  4.026608e-06 -6.453766e-06

``` r
# lasso penalty (lam = 0.1)
ADMMsigma(X, lam = 0.1)
```

    ## $Iterations
    ## [1] 26
    ## 
    ## $lam
    ## [1] 0.1
    ## 
    ## $Omega
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,]  1.356661e+00 -0.4001557425 -2.867106e-01 -7.084100e-02
    ##  [2,] -4.001557e-01  1.4269505429 -5.481806e-01  2.135669e-04
    ##  [3,] -2.867106e-01 -0.5481805649  1.646024e+00 -6.871715e-01
    ##  [4,] -7.084100e-02  0.0002135669 -6.871715e-01  1.754944e+00
    ##  [5,]  5.609014e-05  0.0002888783 -3.048186e-02 -7.332922e-01
    ##  [6,]  9.978565e-05  0.0003252120 -4.151570e-05 -1.915857e-01
    ##  [7,]  1.725982e-04  0.0003777443  6.490825e-06  1.507921e-05
    ##  [8,]  2.307271e-04  0.0004240921 -1.297208e-02  6.641447e-05
    ##  [9,]  2.351597e-04  0.0003958385 -1.483439e-02  9.740062e-05
    ## [10,]  1.697258e-04  0.0002833388 -3.464377e-02  6.737890e-05
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  5.609014e-05  9.978565e-05  1.725982e-04  2.307271e-04
    ##  [2,]  2.888783e-04  3.252120e-04  3.777443e-04  4.240921e-04
    ##  [3,] -3.048186e-02 -4.151570e-05  6.490825e-06 -1.297208e-02
    ##  [4,] -7.332922e-01 -1.915857e-01  1.507921e-05  6.641447e-05
    ##  [5,]  1.705909e+00 -6.768789e-01 -1.458101e-01  3.698932e-05
    ##  [6,] -6.768789e-01  1.799837e+00 -5.411743e-01 -1.845796e-01
    ##  [7,] -1.458101e-01 -5.411743e-01  1.541344e+00 -5.361534e-01
    ##  [8,]  3.698932e-05 -1.845796e-01 -5.361534e-01  1.612251e+00
    ##  [9,]  5.322741e-05 -7.387394e-03 -1.567825e-02 -7.015340e-01
    ## [10,] -8.627394e-02 -2.828283e-05 -5.581897e-05 -4.547561e-02
    ##                [,9]         [,10]
    ##  [1,]  2.351597e-04  1.697258e-04
    ##  [2,]  3.958385e-04  2.833388e-04
    ##  [3,] -1.483439e-02 -3.464377e-02
    ##  [4,]  9.740062e-05  6.737890e-05
    ##  [5,]  5.322741e-05 -8.627394e-02
    ##  [6,] -7.387394e-03 -2.828283e-05
    ##  [7,] -1.567825e-02 -5.581897e-05
    ##  [8,] -7.015340e-01 -4.547561e-02
    ##  [9,]  1.501138e+00 -6.246432e-01
    ## [10,] -6.246432e-01  1.350610e+00
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -3.011369e-07 -9.689122e-06  3.890979e-05 -5.890285e-05
    ##  [2,] -9.689122e-06  8.124131e-06 -6.540056e-05  1.798731e-01
    ##  [3,]  3.890979e-05 -6.540056e-05 -2.310844e-05  1.325267e-04
    ##  [4,] -5.890285e-05  1.798731e-01  1.325267e-04 -2.432819e-04
    ##  [5,]  1.856035e-01  9.237780e-02 -1.036388e-04  2.110706e-04
    ##  [6,]  1.785964e-01  8.473143e-02 -1.998961e-03 -8.927556e-05
    ##  [7,]  1.596914e-01  4.076179e-02  1.653333e-01  1.880208e-01
    ##  [8,]  1.259091e-01  8.176106e-02 -2.844737e-05  1.823031e-01
    ##  [9,]  3.226897e-02  1.958107e-02 -3.851377e-05  1.345737e-01
    ## [10,]  1.053324e-01  6.592348e-02 -1.505153e-05  1.636581e-01
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  1.856035e-01  1.785964e-01  1.596914e-01  1.259091e-01
    ##  [2,]  9.237780e-02  8.473143e-02  4.076179e-02  8.176106e-02
    ##  [3,] -1.036388e-04 -1.998961e-03  1.653333e-01 -2.844737e-05
    ##  [4,]  2.110706e-04 -8.927556e-05  1.880208e-01  1.823031e-01
    ##  [5,] -2.474978e-04  1.653410e-04 -5.569163e-05  1.669240e-01
    ##  [6,]  1.653410e-04 -1.497132e-04  7.907674e-05 -2.503921e-05
    ##  [7,] -5.569163e-05  7.907674e-05 -6.558376e-05  6.126358e-05
    ##  [8,]  1.669240e-01 -2.503921e-05  6.126358e-05 -1.035108e-04
    ##  [9,]  1.443530e-01 -3.578375e-06 -3.356579e-05  8.584917e-05
    ## [10,] -2.424729e-06 -4.807248e-02 -7.987621e-03 -2.617623e-05
    ##                [,9]         [,10]
    ##  [1,]  3.226897e-02  1.053324e-01
    ##  [2,]  1.958107e-02  6.592348e-02
    ##  [3,] -3.851377e-05 -1.505153e-05
    ##  [4,]  1.345737e-01  1.636581e-01
    ##  [5,]  1.443530e-01 -2.424729e-06
    ##  [6,] -3.578375e-06 -4.807248e-02
    ##  [7,] -3.356579e-05 -7.987621e-03
    ##  [8,]  8.584917e-05 -2.617623e-05
    ##  [9,] -9.271198e-05  4.440923e-05
    ## [10,]  4.440923e-05 -2.378492e-05

``` r
#elastic-net type penalty (use CV for optimal lambda)
ADMMsigma(X, alpha = 0.5)
```

    ## $Iterations
    ## [1] 26
    ## 
    ## $lam
    ## [1] 0.03162278
    ## 
    ## $Omega
    ##                [,1]         [,2]          [,3]          [,4]         [,5]
    ##  [1,]  1.700056e+00 -0.592302184 -0.3964331405 -7.897602e-02 -0.012989997
    ##  [2,] -5.923022e-01  1.862900281 -0.8658377586 -2.761443e-02  0.082443029
    ##  [3,] -3.964331e-01 -0.865837759  2.2923499573 -9.869512e-01 -0.020293703
    ##  [4,] -7.897602e-02 -0.027614431 -0.9869511929  2.395606e+00 -1.090700624
    ##  [5,] -1.299000e-02  0.082443029 -0.0202937028 -1.090701e+00  2.328999393
    ##  [6,] -2.011375e-02  0.007331655 -0.0001402301 -2.331614e-01 -1.004744509
    ##  [7,] -6.704179e-02  0.113072198 -0.0001390927 -1.252198e-04 -0.171618506
    ##  [8,] -1.759384e-02 -0.011972307 -0.0050548001 -4.200045e-05  0.007328115
    ##  [9,]  1.292782e-01  0.085660409 -0.1701389650  5.441349e-02  0.079693199
    ## [10,] -3.530603e-05  0.011934196 -0.0723027269  9.109165e-05 -0.186962468
    ##                [,6]          [,7]          [,8]          [,9]
    ##  [1,] -0.0201137547 -0.0670417927 -1.759384e-02  0.1292781764
    ##  [2,]  0.0073316546  0.1130721981 -1.197231e-02  0.0856604085
    ##  [3,] -0.0001402301 -0.0001390927 -5.054800e-03 -0.1701389650
    ##  [4,] -0.2331614324 -0.0001252198 -4.200045e-05  0.0544134911
    ##  [5,] -1.0047445086 -0.1716185059  7.328115e-03  0.0796931985
    ##  [6,]  2.4487464685 -0.7965686880 -2.297695e-01 -0.0637154465
    ##  [7,] -0.7965686880  2.0304244001 -7.764847e-01  0.0002486013
    ##  [8,] -0.2297695317 -0.7764846839  2.155406e+00 -1.0249525600
    ##  [9,] -0.0637154465  0.0002486013 -1.024953e+00  2.0292607853
    ## [10,]  0.0760622670  0.0001152010 -2.821209e-02 -0.9185339773
    ##               [,10]
    ##  [1,] -3.530603e-05
    ##  [2,]  1.193420e-02
    ##  [3,] -7.230273e-02
    ##  [4,]  9.109165e-05
    ##  [5,] -1.869625e-01
    ##  [6,]  7.606227e-02
    ##  [7,]  1.152010e-04
    ##  [8,] -2.821209e-02
    ##  [9,] -9.185340e-01
    ## [10,]  1.701544e+00
    ## 
    ## $Gradient
    ##                [,1]          [,2]          [,3]          [,4]
    ##  [1,] -4.023352e-06 -1.516803e-06  1.096668e-05 -1.071522e-05
    ##  [2,] -1.516803e-06 -3.765428e-05  8.132824e-05 -8.525643e-05
    ##  [3,]  1.096668e-05  8.132824e-05 -2.048346e-04  2.403905e-04
    ##  [4,] -1.071522e-05 -8.525643e-05  2.403905e-04 -3.227378e-04
    ##  [5,]  3.022670e-06  2.215372e-05 -1.203690e-04  2.484864e-04
    ##  [6,] -3.520232e-06  2.527852e-05 -5.782599e-03 -6.916437e-05
    ##  [7,]  1.488611e-05  1.333264e-06 -2.198191e-02 -9.838412e-03
    ##  [8,] -1.249896e-06 -5.828464e-07  9.302065e-06 -1.003120e-02
    ##  [9,] -5.141422e-06 -2.223386e-05  4.127162e-05 -2.013288e-05
    ## [10,] -4.336310e-03  1.102115e-05 -1.530014e-05  7.600119e-03
    ##                [,5]          [,6]          [,7]          [,8]
    ##  [1,]  3.022670e-06 -3.520232e-06  1.488611e-05 -1.249896e-06
    ##  [2,]  2.215372e-05  2.527852e-05  1.333264e-06 -5.828464e-07
    ##  [3,] -1.203690e-04 -5.782599e-03 -2.198191e-02  9.302065e-06
    ##  [4,]  2.484864e-04 -6.916437e-05 -9.838412e-03 -1.003120e-02
    ##  [5,] -2.980452e-04  1.849304e-04 -4.122402e-05  2.066690e-05
    ##  [6,]  1.849304e-04 -1.979484e-04  9.189069e-05 -3.369226e-06
    ##  [7,] -4.122402e-05  9.189069e-05 -6.596503e-05  6.210056e-07
    ##  [8,]  2.066690e-05 -3.369226e-06  6.210056e-07 -5.517010e-05
    ##  [9,] -2.920979e-05 -4.676952e-07  2.697464e-02  6.779967e-05
    ## [10,]  2.817411e-05 -2.239072e-05  2.716430e-02 -4.509373e-05
    ##                [,9]         [,10]
    ##  [1,] -5.141422e-06 -4.336310e-03
    ##  [2,] -2.223386e-05  1.102115e-05
    ##  [3,]  4.127162e-05 -1.530014e-05
    ##  [4,] -2.013288e-05  7.600119e-03
    ##  [5,] -2.920979e-05  2.817411e-05
    ##  [6,] -4.676952e-07 -2.239072e-05
    ##  [7,]  2.697464e-02  2.716430e-02
    ##  [8,]  6.779967e-05 -4.509373e-05
    ##  [9,] -1.157551e-04  6.342082e-05
    ## [10,]  6.342082e-05 -3.795736e-05
